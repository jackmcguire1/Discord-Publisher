import{u as f,a as d,b as p,c as g,r as n,j as a,M as m}from"./index-d92f5b56.js";import{R as x,h as v}from"./index-e151b7a6.js";function k(){const i=f();d(t=>t.create);const r=p(),l=g(t=>t.webhookUrl),[c,s]=n.useState("{}"),u=n.useRef(new Set);n.useEffect(()=>{s("Publishing message...");const t=l||"";if(!t){s("Please set a webhook URL in the settings.");return}if(u.current.has(r))return;const e=h(r);fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(()=>s("Successfully published message")).catch(o=>{s("Failed to publish message"),console.log("Error publishing message:",o,t,JSON.stringify(e,null,2))}),u.current.add(r)},[r,l]);function h(t){return{content:t.content||"",username:t.username||"",avatar_url:t.avatar_url||"",tts:!!t.tts,embeds:(t.embeds||[]).map(e=>({url:e.url,title:e.title,description:e.description,color:e.color,image:e.image?{url:e.image.url}:void 0,footer:e.footer?{text:e.footer.text,icon_url:e.footer.icon_url}:void 0,timestamp:e.timestamp,author:e.author?{url:e.author.url,name:e.author.name,icon_url:e.author.icon_url}:void 0,thumbnail:e.thumbnail?{url:e.thumbnail.url}:void 0,fields:e.fields?e.fields.map(o=>({name:o.name,value:o.value,inline:o.inline})):[]})),components:t.components||[],flags:t.flags||0}}return a.jsx(m,{onClose:()=>i("/editor"),children:a.jsxs("div",{className:"h-full flex flex-col p-1.5 md:p-3",children:[a.jsx(x,{className:"flex-1 rounded overflow-hidden",height:"100%",width:"100%",value:c,basicSetup:{lineNumbers:!1,foldGutter:!1,indentOnInput:!0},theme:v,onChange:t=>s(t)}),a.jsx("div",{className:"mt-3 flex justify-end space-x-2",children:a.jsx("button",{className:"border-2 border-dark-7 hover:bg-dark-5 px-3 py-2 rounded text-white",onClick:()=>i("/editor"),children:"Cancel"})})]})})}export{k as default};
