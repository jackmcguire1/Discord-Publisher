import{P as $,Q as ee,R as se,U as D,V as te,j as e,W as ae,X as ne,f as y,Y as M,x as oe,r as p,C as U,k as R,Z as le,$ as V,a0 as K,a1 as H,a2 as q,a3 as W,v as G,E,a4 as ie,y as T,c as B,I as w,a as L,m as X,a5 as ce,a6 as re,a7 as de,T as k,a8 as xe,a9 as me,w as ue,aa as he,ab as pe,t as ge,g as fe,ac as ve,ad as je,L as Ne}from"./index-be7f8796.js";import{C as O}from"./CheckBox-17e2ff57.js";import{S as be}from"./index-fee9f52a.js";import{a as ye}from"./PremiumSuggest-42cedb32.js";import{p as F}from"./index-e4f144c6.js";const Y=l=>$()(ee(se((a,c)=>({actions:{},clear:()=>a({actions:{}}),setActionSet:(t,s)=>a(n=>{n.actions[t]=s}),addAction:(t,s)=>a(n=>{const i=n.actions[t];i?i.actions.push(s):n.actions[t]={actions:[s]}}),clearActions:t=>a(s=>{const n=s.actions[t];n&&(n.actions=[])}),deleteAction:(t,s)=>a(n=>{const i=n.actions[t];i&&i.actions.splice(s,1)}),moveActionUp:(t,s)=>a(n=>{const i=n.actions[t];if(i){const r=i.actions[s];r&&(i.actions.splice(s,1),i.actions.splice(s-1,0,r))}}),moveActionDown:(t,s)=>{a(n=>{const i=n.actions[t];if(i){const r=i.actions[s];r&&(i.actions.splice(s,1),i.actions.splice(s+1,0,r))}})},duplicateAction:(t,s)=>{a(n=>{const i=n.actions[t];if(i){const r=i.actions[s];r&&i.actions.splice(s+1,0,{...r,id:D()})}})},setActionType:(t,s,n)=>a(i=>{const r=i.actions[t],o=r.actions[s];n===1||n===6||n===8?r.actions[s]={type:n,id:o.id,text:"",public:!1,allow_role_mentions:!1}:n===5||n===7||n===9?r.actions[s]={type:n,id:o.id,target_id:"",public:!1,allow_role_mentions:!1}:n===2||n===3||n===4?r.actions[s]={type:n,id:o.id,target_id:"",public:!1,disable_default_response:!1,allow_role_mentions:!1}:n===10&&(r.actions[s]={type:n,id:o.id,permissions:"0",role_ids:[],disable_default_response:!1})}),setActionText:(t,s,n)=>a(i=>{const o=i.actions[t].actions[s];(o.type===1||o.type===6||o.type===8||o.type===10&&o.disable_default_response)&&(o.text=n)}),setActionTargetId:(t,s,n)=>a(i=>{const o=i.actions[t].actions[s];(o.type===2||o.type===3||o.type===4||o.type===5||o.type===7||o.type===9)&&(o.target_id=n)}),setActionPublic:(t,s,n)=>a(i=>{const o=i.actions[t].actions[s];o.type!==10&&(o.public=n)}),setActionAllowRoleMentions:(t,s,n)=>a(i=>{const o=i.actions[t].actions[s];o.type!==10&&(o.allow_role_mentions=n)}),setActionDisableDefaultResponse:(t,s,n)=>a(i=>{const o=i.actions[t].actions[s];(o.type===2||o.type===3||o.type===4||o.type===10)&&(o.disable_default_response=n)}),setActionPermissions:(t,s,n)=>a(i=>{const o=i.actions[t].actions[s];o.type===10&&(o.permissions=n)}),setActionRoleIds:(t,s,n)=>a(i=>{const o=i.actions[t].actions[s];o.type===10&&(o.role_ids=n)})}),{name:l,version:0})));Y("current-message-actions");const b=Y("custom-commands-actions"),Q=$()((l,a)=>({states:{},getCollapsed:(c,t=!1)=>{const s=a().states[c];return s===void 0?t:s},toggleCollapsed:(c,t=!1)=>{const s=a().states,n=s[c]===void 0?t:s[c];s[c]=!n,l({states:s})},clearCollapsed:c=>{const t=a().states;delete t[c],l({states:t})},clearCollapsedWithPrefix(c){const t=a().states;for(const s in t)s.startsWith(c)&&delete t[s];l({states:t})}})),Se=(l,a=!1)=>{const c=Q(n=>n.getCollapsed(l,a)),t=Q(n=>n.toggleCollapsed);return[c,()=>t(l,a)]};function Ce({pathPrefix:l}){return te(c=>typeof l=="string"?c.checkIssueByPathPrefix(l):l.some(t=>c.checkIssueByPathPrefix(t)))?e.jsx(ae,{className:"h-5 w-5 text-red"}):null}function P({id:l,children:a,title:c,size:t="medium",extra:s,buttons:n,validationPathPrefix:i,defaultCollapsed:r}){const[o,m]=Se(l,r);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-gray-300 cursor-pointer truncate space-x-3",children:[e.jsxs("div",{className:"flex items-center flex-auto truncate space-x-1",onClick:()=>m(),children:[e.jsx(ne,{className:y("transition-transform duration-300 flex-none",!o&&"rotate-90",t==="large"&&"w-7 h-7",t==="medium"&&"w-6 h-6")}),e.jsx("div",{className:y("flex-none",t==="large"&&"text-lg"),children:c}),i&&e.jsx("div",{className:"flex-none",children:e.jsx(Ce,{pathPrefix:i})}),s]}),e.jsx("div",{className:"flex-none",children:n})]}),e.jsx(M,{children:!o&&e.jsx("div",{className:"mt-3",children:a})})]})}function Ee({guildId:l,messageId:a,onChange:c}){const{data:t,isLoading:s}=oe(l),n=p.useMemo(()=>(t==null?void 0:t.success)&&t.data.find(m=>m.id===a),[t,a]);p.useEffect(()=>{s||(!(t!=null&&t.success)||!t.data.find(m=>m.id===a))&&c(null)},[t,a,s]);function i(m){c(m),o(!1)}const[r,o]=p.useState(!1);return e.jsx(U,{onClickOutside:()=>o(!1),children:e.jsxs("div",{className:"px-3 rounded bg-dark-2 relative flex items-center h-10 select-none",children:[e.jsx("div",{onClick:()=>o(m=>!m),role:"button",className:"flex-auto",children:l?n?e.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer w-full",children:[e.jsx("div",{}),e.jsx("div",{className:"text-lg text-gray-300 flex-auto truncate",children:n.name}),e.jsx(R,{className:y("text-white w-5 h-5 flex-none transition-transform",r&&"rotate-180")})]}):e.jsx("div",{className:"text-gray-300",children:"Select saved message"}):e.jsx("div",{className:"text-gray-300",children:"Select server at the top"})}),r&&e.jsx("div",{className:"absolute bg-dark-2 top-14 left-0 rounded shadow-lg w-full border-2 border-dark-2 z-10",children:t!=null&&t.success&&t.data.length>0?t.data.map(m=>e.jsxs("div",{className:"py-2 flex space-x-2 items-center hover:bg-dark-3 rounded cursor-pointer px-3",role:"button",onClick:()=>i(m.id),children:[e.jsx("div",{}),e.jsx("div",{className:"text-gray-300",children:m.name})]},m.id)):e.jsx("div",{className:"text-gray-300 p-2",children:"No saved messages"})})]})})}function _e({guildId:l,roleIds:a,onChange:c}){const{data:t}=le(l),s=p.useMemo(()=>(t==null?void 0:t.success)&&t.data.find(o=>o.id===a[0]),[t,a[0]]);function n(o){if(a.includes(o)){c(a.filter(m=>m!==o));return}else c([...a,o])}const[i,r]=p.useState(!1);return p.useEffect(()=>{t!=null&&t.success&&t.data.sort((o,m)=>m.position-o.position)},[t]),e.jsx(U,{onClickOutside:()=>r(!1),children:e.jsxs("div",{className:"px-3 h-10 flex items-center rounded bg-dark-2 relative select-none",children:[e.jsx("div",{role:"button",onClick:()=>r(o=>!o),className:"flex-auto",children:s?e.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer w-full",children:[e.jsxs("div",{className:"flex-auto flex space-x-2 items-center",children:[e.jsx("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:V(s.color)}}),e.jsx("div",{className:"text-gray-300 truncate",children:s.name}),a.length>1&&e.jsxs("div",{className:"text-gray-400 font-light",children:["+ ",a.length-1," others"]})]}),e.jsx(R,{className:y("text-white w-5 h-5 flex-none transition-transform",i&&"rotate-180")})]}):e.jsx("div",{className:"text-gray-300",children:"Select roles"})}),i&&e.jsx("div",{className:"absolute bg-dark-2 top-14 left-0 rounded shadow-lg w-full border-2 border-dark-2 z-10 max-h-48 overflow-y-auto overflow-x-none",children:t!=null&&t.success&&t.data.length?t.data.map(o=>e.jsxs("div",{className:y("py-2 flex space-x-2 items-center hover:bg-dark-3 hover:bg-opacity-100 rounded cursor-pointer px-3",a.includes(o.id)&&"bg-dark-3 bg-opacity-50"),role:"button",onClick:()=>n(o.id),children:[e.jsx("div",{className:"h-4 w-4 rounded-full",style:{backgroundColor:V(o.color)}}),e.jsx("div",{className:"text-gray-300 truncate flex-auto",children:o.name}),a.includes(o.id)&&e.jsx(K,{className:"h-5 w-5 text-gray-300"})]},o.id)):e.jsx("div",{className:"p-2 text-gray-300",children:"No roles found"})})]})})}const A={CREATE_INSTANT_INVITE:BigInt("0x0000000000000001"),KICK_MEMBERS:BigInt("0x0000000000000002"),BAN_MEMBERS:BigInt("0x0000000000000004"),ADMINISTRATOR:BigInt("0x0000000000000008"),MANAGE_CHANNELS:BigInt("0x0000000000000010"),MANAGE_GUILD:BigInt("0x0000000000000020"),ADD_REACTIONS:BigInt("0x0000000000000040"),VIEW_AUDIT_LOG:BigInt("0x0000000000000080"),PRIORITY_SPEAKER:BigInt("0x0000000000000100"),STREAM:BigInt("0x0000000000000200"),VIEW_CHANNEL:BigInt("0x0000000000000400"),SEND_MESSAGES:BigInt("0x0000000000000800"),SEND_TTS_MESSAGES:BigInt("0x0000000000001000"),MANAGE_MESSAGES:BigInt("0x0000000000002000"),EMBED_LINKS:BigInt("0x0000000000004000"),ATTACH_FILES:BigInt("0x0000000000008000"),READ_MESSAGE_HISTORY:BigInt("0x0000000000010000"),MENTION_EVERYONE:BigInt("0x0000000000020000"),USE_EXTERNAL_EMOJIS:BigInt("0x0000000000040000"),VIEW_GUILD_INSIGHTS:BigInt("0x0000000000080000"),CONNECT:BigInt("0x0000000000100000"),SPEAK:BigInt("0x0000000000200000"),MUTE_MEMBERS:BigInt("0x0000000000400000"),DEAFEN_MEMBERS:BigInt("0x0000000000800000"),MOVE_MEMBERS:BigInt("0x0000000001000000"),USE_VAD:BigInt("0x0000000002000000"),CHANGE_NICKNAME:BigInt("0x0000000004000000"),MANAGE_NICKNAMES:BigInt("0x0000000008000000"),MANAGE_ROLES:BigInt("0x0000000010000000"),MANAGE_WEBHOOKS:BigInt("0x0000000020000000"),MANAGE_GUILD_EXPRESSIONS:BigInt("0x0000000040000000"),USE_APPLICATION_COMMANDS:BigInt("0x0000000080000000"),REQUEST_TO_SPEAK:BigInt("0x0000000100000000"),MANAGE_EVENTS:BigInt("0x0000000200000000"),MANAGE_THREADS:BigInt("0x0000000400000000"),CREATE_PUBLIC_THREADS:BigInt("0x0000000800000000"),CREATE_PRIVATE_THREADS:BigInt("0x0000001000000000"),USE_EXTERNAL_STICKERS:BigInt("0x0000002000000000"),SEND_MESSAGES_IN_THREADS:BigInt("0x0000004000000000"),USE_EMBEDDED_ACTIVITIES:BigInt("0x0000008000000000"),MODERATE_MEMBERS:BigInt("0x0000010000000000"),VIEW_CREATOR_MONETIZATION_ANALYTICS:BigInt("0x0000020000000000"),USE_SOUNDBOARD:BigInt("0x0000040000000000"),CREATE_GUILD_EXPRESSIONS:BigInt("0x0000080000000000"),CREATE_EVENTS:BigInt("0x0000100000000000"),USE_EXTERNAL_SOUNDS:BigInt("0x0000200000000000"),SEND_VOICE_MESSAGES:BigInt("0x0000400000000000"),SEND_POLLS:BigInt("0x0002000000000000")};function Ae({permissions:l,onChange:a}){const c=p.useMemo(()=>BigInt(l),[l]),t=p.useMemo(()=>Object.keys(A).filter(r=>c&A[r]),[c]);function s(r){if(c&A[r]){a((c^A[r]).toString());return}else a((c|A[r]).toString())}const[n,i]=p.useState(!1);return e.jsx(U,{onClickOutside:()=>i(!1),children:e.jsxs("div",{className:"px-3 h-10 flex items-center rounded bg-dark-2 relative select-none",children:[e.jsx("div",{role:"button",onClick:()=>i(r=>!r),className:"flex-auto",children:t.length?e.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer w-full",children:[e.jsxs("div",{className:"flex-auto flex space-x-2 items-center",children:[e.jsx(H,{className:"h-5 w-5 text-gray-500"}),e.jsx("div",{className:"text-gray-300 truncate",children:t[0].replaceAll("_"," ")}),t.length>1&&e.jsxs("div",{className:"text-gray-400 font-light",children:["+ ",t.length-1," others"]})]}),e.jsx(R,{className:y("text-white w-5 h-5 flex-none transition-transform",n&&"rotate-180")})]}):e.jsx("div",{className:"text-gray-300",children:"Select permissions"})}),n&&e.jsx("div",{className:"absolute bg-dark-2 top-14 left-0 rounded shadow-lg w-full border-2 border-dark-2 z-10 max-h-48 overflow-y-auto overflow-x-none",children:Object.keys(A).map(r=>e.jsxs("div",{className:y("py-2 flex space-x-2 items-center hover:bg-dark-3 hover:bg-opacity-100 rounded cursor-pointer px-3",t.includes(r)&&"bg-dark-3 bg-opacity-50"),role:"button",onClick:()=>s(r),children:[e.jsx(H,{className:"h-5 w-5 text-gray-500"}),e.jsx("div",{className:"text-gray-300 truncate flex-auto",children:r.replaceAll("_"," ")}),t.includes(r)&&e.jsx(K,{className:"h-5 w-5 text-gray-300"})]},r))})]})})}const we={1:"Text Response",6:"Text DM",8:"Text Message Edit",5:"Saved Message Response",7:"Saved Message DM",9:"Saved Message Edit",2:"Toggle Role",3:"Add Role",4:"Remove Role",10:"Check Permissions"},ke={1:"Respond with a text message to the channel.",2:"Toggle a role for the user.",3:"Add a role to the user.",4:"Remove a role from the user.",5:"Respond with a saved message to the channel.",6:"Send a text message to the user via DM.",7:"Send a saved message to the user via DM.",8:"Edit the message with a new text message.",9:"Edit the message with a saved message.",10:"Check if the user has the required permissions and roles."};function Me({guildId:l,actionCount:a,maxActions:c,actionIndex:t,action:s,collapsableId:n,valiationPathPrefix:i,moveUp:r,moveDown:o,duplicate:m,remove:N,setType:u,setText:j,setTargetId:x,setPublic:g,setAllowRoleMentions:S,setDisableDefaultResponse:h,setRoleIds:C,setPermissions:v}){const d=p.useMemo(()=>{switch(s.type){case 1:case 6:case 8:return"text_response";case 5:case 7:case 9:return"saved_message_response";case 2:return"toggle_role";case 3:return"add_role";case 4:return"remove_role";case 10:return"check_permissions"}},[s.type]);function _(f){switch(f){case"text_response":u(1);break;case"saved_message_response":u(5);break;case"toggle_role":u(2);break;case"add_role":u(3);break;case"remove_role":u(4);break;case"check_permissions":u(10);break}}const I=p.useMemo(()=>{switch(s.type){case 1:case 5:return"channel";case 6:case 7:return"dm";case 8:case 9:return"edit"}},[s.type]);function J(f){switch(f){case"channel":u(d==="text_response"?1:5);break;case"dm":u(d==="text_response"?6:7);break;case"edit":u(d==="text_response"?8:9);break}}return e.jsx("div",{className:"p-3 border-2 border-dark-6 rounded-md",children:e.jsx(P,{id:n,validationPathPrefix:i,title:`Action ${t+1}`,buttons:e.jsxs("div",{className:"flex-none text-gray-300 flex items-center space-x-2",children:[t>0&&e.jsx(q,{className:"h-6 w-6 flex-none",role:"button",onClick:r}),t<a-1&&e.jsx(R,{className:"h-6 w-6 flex-none",role:"button",onClick:o}),a<c&&e.jsx(W,{className:"h-5 w-5 flex-none",role:"button",onClick:m}),e.jsx(G,{className:"h-5 w-5 flex-none",role:"button",onClick:N})]}),extra:e.jsxs("div",{className:"text-gray-500 truncate flex space-x-2 pl-1",children:[e.jsx("div",{children:"-"}),e.jsx("div",{className:"truncate",children:we[s.type]})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-3 xl:flex-row xl:space-x-3 xl:space-y-0",children:[e.jsxs("div",{className:"flex flex-col space-y-3 lg:flex-row lg:space-x-3 lg:space-y-0",children:[e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Type"})}),e.jsxs("select",{className:"bg-dark-2 rounded p-2 w-full no-ring font-light cursor-pointer text-white",value:d,onChange:f=>_(f.target.value),children:[e.jsx("option",{value:"text_response",children:"Text Response"}),e.jsx("option",{value:"saved_message_response",children:"Saved Message Response"}),e.jsx("option",{value:"toggle_role",children:"Toggle Role"}),e.jsx("option",{value:"add_role",children:"Add Role"}),e.jsx("option",{value:"remove_role",children:"Remove Role"}),e.jsx("option",{value:"check_permissions",children:"Check Permissions"})]})]}),(d==="text_response"||d==="saved_message_response")&&e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Target"})}),e.jsxs("select",{className:"bg-dark-2 rounded p-2 w-full no-ring font-light cursor-pointer text-white",value:I,onChange:f=>J(f.target.value),children:[e.jsx("option",{value:"channel",children:"Channel Message"}),e.jsx("option",{value:"dm",children:"Direct Message"}),e.jsx("option",{value:"edit",children:"Edit Message"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-3 lg:flex-row lg:space-x-3 lg:space-y-0",children:[(s.type===1||s.type===5)&&e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Public"})}),e.jsx(O,{checked:s.public,onChange:g})]}),(s.type===1||s.type===5)&&e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Ping Roles"})}),e.jsx(O,{checked:s.allow_role_mentions,onChange:f=>S(f)})]}),(s.type===2||s.type===3||s.type===4||s.type===10)&&e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Default Response"})}),e.jsx(O,{checked:!s.disable_default_response,onChange:f=>h(!f)})]})]})]}),s.type===1||s.type===6||s.type===8?e.jsx(E,{label:"Response",type:"textarea",value:s.text,onChange:f=>j(f),controls:!0}):s.type===2||s.type===3||s.type===4?e.jsx(ie,{guildId:l,roleId:s.target_id||null,onChange:f=>x(f||"")}):s.type===5||s.type===7||s.type===9?e.jsx(Ee,{guildId:l,messageId:s.target_id||null,onChange:f=>x(f||"")}):s.type===10?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Required Permissions"})}),e.jsx(Ae,{permissions:s.permissions,onChange:v})]}),e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Required Roles"})}),e.jsx(_e,{guildId:l,roleIds:s.role_ids,onChange:C})]}),s.disable_default_response&&e.jsx(E,{label:"Error Response",type:"textarea",value:s.text||"",onChange:f=>j(f),controls:!0})]}):null,e.jsx("div",{className:"text-gray-500 text-sm whitespace-normal",children:ke[s.type]})]})})})}function Re({cmdId:l,actionIndex:a}){const c=T(),t=(c==null?void 0:c.max_actions_per_component)||0,s=B(d=>d.guildId),n=b(d=>{var _;return(_=d.actions[l])==null?void 0:_.actions[a]},w),i=b(d=>{var _,I;return((I=(_=d.actions[l])==null?void 0:_.actions)==null?void 0:I.length)||0}),[r,o,m,N]=b(d=>[d.moveActionUp,d.moveActionDown,d.duplicateAction,d.deleteAction],w),[u,j,x,g,S,h,C,v]=b(d=>[d.setActionType,d.setActionText,d.setActionTargetId,d.setActionPublic,d.setActionAllowRoleMentions,d.setActionDisableDefaultResponse,d.setActionRoleIds,d.setActionPermissions],w);return e.jsx(Me,{guildId:s,actionCount:i,maxActions:t,actionIndex:a,action:n,collapsableId:`actions.${l}.actions.${n.id}`,moveUp:()=>r(l,a),moveDown:()=>o(l,a),duplicate:()=>m(l,a),remove:()=>N(l,a),setText:d=>j(l,a,d),setType:d=>u(l,a,d),setTargetId:d=>x(l,a,d),setPublic:d=>g(l,a,d),setAllowRoleMentions:d=>S(l,a,d),setDisableDefaultResponse:d=>h(l,a,d),setRoleIds:d=>C(l,a,d),setPermissions:d=>v(l,a,d)})}function Z({cmdId:l}){const a=T(),c=(a==null?void 0:a.max_actions_per_component)||0,t=b(r=>{var o;return((o=r.actions[l])==null?void 0:o.actions.map(m=>m.id))||[]},w),[s,n]=b(r=>[r.addAction,r.clearActions],w);function i(){s(l,{id:D(),type:1,text:"",public:!1,allow_role_mentions:!1})}return e.jsxs(P,{id:`actions.${l}`,validationPathPrefix:`actions.${l}`,title:"Actions",extra:e.jsxs("div",{className:"text-sm italic font-light text-gray-400",children:[t.length," / ",c]}),children:[e.jsx(M,{className:"space-y-2",children:t.map((r,o)=>e.jsx(Re,{cmdId:l,actionIndex:o},r))}),e.jsxs("div",{className:"space-x-3 mt-3 text-sm",children:[t.length<c?e.jsx("button",{className:"bg-blurple px-3 py-2 rounded transition-colors hover:bg-blurple-dark text-white",onClick:i,children:"Add Action"}):e.jsx("button",{disabled:!0,className:"bg-dark-2 px-3 py-2 rounded transition-colors cursor-not-allowed text-gray-300",children:"Add Action"}),e.jsx("button",{className:"px-3 py-2 rounded border-2 border-red hover:bg-red transition-colors text-white",onClick:()=>n(l),children:"Clear Actions"})]})]})}function Ie({cmdId:l,parameters:a,parameterIndex:c,maxParameters:t,setParameters:s}){const n=a[c];function i(){const x=[...a];x.splice(c-1,0,x.splice(c,1)[0]),s(x)}function r(){const x=[...a];x.splice(c+1,0,x.splice(c,1)[0]),s(x)}function o(){const x=[...a];x.splice(c,0,{...n,id:D()}),s(x)}function m(){const x=[...a];x.splice(c,1),s(x)}function N(x){const g=[...a];g[c].type=parseInt(x),s(g)}function u(x){const g=[...a];g[c].name=x,s(g)}function j(x){const g=[...a];g[c].description=x,s(g)}return e.jsx("div",{className:"p-3 border-2 border-dark-6 rounded-md",children:e.jsx(P,{id:`command.${l}.parameters.${n.id}`,title:`Argument ${c+1}`,buttons:e.jsxs("div",{className:"flex-none text-gray-300 flex items-center space-x-2",children:[c>0&&e.jsx(q,{className:"h-6 w-6 flex-none",role:"button",onClick:i}),c<a.length-1&&e.jsx(R,{className:"h-6 w-6 flex-none",role:"button",onClick:r}),a.length<t&&e.jsx(W,{className:"h-5 w-5 flex-none",role:"button",onClick:o}),e.jsx(G,{className:"h-5 w-5 flex-none",role:"button",onClick:m})]}),extra:n.name?e.jsxs("div",{className:"text-gray-500 truncate flex space-x-2 pl-2",children:[e.jsx("div",{children:"-"}),e.jsx("div",{className:"truncate",children:n.name})]}):null,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex flex-col space-y-3 lg:flex-row lg:space-x-3 lg:space-y-0",children:e.jsxs("div",{className:"flex-none",children:[e.jsx("div",{className:"mb-1.5 flex",children:e.jsx("div",{className:"uppercase text-gray-300 text-sm font-medium",children:"Type"})}),e.jsxs("select",{className:"bg-dark-2 rounded p-2 w-full no-ring font-light cursor-pointer text-white",value:n.type.toString(),onChange:x=>N(x.target.value),children:[e.jsx("option",{value:"3",children:"Text"}),e.jsx("option",{value:"4",children:"Whole Number"}),e.jsx("option",{value:"10",children:"Decimal Number"}),e.jsx("option",{value:"5",children:"True / False"}),e.jsx("option",{value:"6",children:"User"}),e.jsx("option",{value:"7",children:"Channel"}),e.jsx("option",{value:"8",children:"Role"}),e.jsx("option",{value:"11",children:"File"})]})]})}),e.jsx(E,{label:"Name",type:"text",maxLength:32,value:n.name,onChange:u}),e.jsx(E,{label:"Description",type:"text",maxLength:100,value:n.description,onChange:j})]})})})}function z({cmdId:l,parameters:a,setParameters:c}){function s(){c([...a,{id:D(),name:"",description:"",type:3}])}return e.jsxs(P,{id:`command.${l}.parameters`,validationPathPrefix:`actions.${l}`,title:"Arguments",extra:e.jsxs("div",{className:"text-sm italic font-light text-gray-400",children:[a.length," / ",5]}),children:[e.jsx(M,{className:"space-y-2",children:a.map((n,i)=>e.jsx(Ie,{cmdId:l,parameterIndex:i,parameters:a,setParameters:c,maxParameters:5,parameterCount:a.length},n.id))}),e.jsxs("div",{className:"space-x-3 mt-3 text-sm",children:[a.length<5?e.jsx("button",{className:"bg-blurple px-3 py-2 rounded transition-colors hover:bg-blurple-dark text-white",onClick:s,children:"Add Parameter"}):e.jsx("button",{disabled:!0,className:"bg-dark-2 px-3 py-2 rounded transition-colors cursor-not-allowed text-gray-300",children:"Add Parameter"}),e.jsx("button",{className:"px-3 py-2 rounded border-2 border-red hover:bg-red transition-colors text-white",onClick:()=>c([]),children:"Clear Parameter"})]})]})}function Te({cmd:l}){const a=B(v=>v.guildId),c=L(v=>v.create),[t,s]=p.useState(!1),[n,i]=p.useState(l.name),[r,o]=p.useState(l.description),[m,N]=p.useState(l.parameters),u=X(),j=ce();p.useEffect(()=>{const v=re.safeParse(l.actions);v.success&&b.getState().setActionSet(l.id,v.data)},[l.actions]);function x(){if(n.length==0||r.length==0)return;const v=b.getState().actions[l.id];j.mutate({guildId:a,commandId:l.id,req:{name:n,description:r,enabled:!0,parameters:m,actions:v||null}},{onSuccess(d){d.success?(s(!1),u.invalidateQueries(["custom-bot",a,"commands"])):c({title:"Failed to update command",message:d.error.message,type:"error"})}})}const g=de(),[S,h]=p.useState(!1);function C(){g.mutate({commandId:l.id,guildId:a},{onSuccess:v=>{v.success?u.invalidateQueries(["custom-bot",a,"commands"]):c({title:"Failed to delete command",message:v.error.message,type:"error"})}})}return e.jsxs("div",{children:[e.jsx(M,{className:"bg-dark-3 rounded",children:t?e.jsxs("div",{className:"px-5 py-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"flex items-center space-x-2 truncate text-lg mb-5",children:e.jsxs("div",{className:"text-white truncate",children:[e.jsx("span",{className:"font-bold text-gray-500 text-xl",children:"/"})," ",l.name]})}),e.jsxs("div",{className:"flex items-center text-white cursor-pointer bg-blurple hover:bg-blurple-dark rounded px-2 py-1",role:"button",onClick:x,children:[e.jsx(k,{text:"Save Command",children:e.jsx(xe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"ml-2",children:["Save ",e.jsx("span",{className:"hidden md:inline-block",children:"Changes"})]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsx(E,{label:"Name",type:"text",maxLength:32,value:n,onChange:i}),e.jsx(E,{label:"Description",type:"text",maxLength:100,value:r,onChange:o}),e.jsx(z,{parameters:m||[],setParameters:N,cmdId:l.id}),e.jsx(Z,{cmdId:l.id})]})]},"1"):e.jsxs("div",{className:"flex justify-between items-start py-4 px-5",children:[e.jsxs("div",{className:"flex-auto truncate",children:[e.jsx("div",{className:"flex items-center space-x-2 truncate text-lg mb-1",children:e.jsxs("div",{className:"text-white truncate",children:[e.jsx("span",{className:"font-bold text-gray-500 text-xl",children:"/"})," ",l.name]})}),e.jsx("div",{className:"text-gray-400 text-sm font-light whitespace-normal",children:l.description})]}),e.jsxs("div",{className:"flex flex-none items-center space-x-4 md:space-x-3",children:[e.jsxs("div",{className:"flex items-center text-gray-300 hover:text-white cursor-pointer md:bg-dark-2 md:rounded md:px-2 md:py-1",role:"button",onClick:()=>h(!0),children:[e.jsx(k,{text:"Delete Command",children:e.jsx(G,{className:"h-5 w-5"})}),e.jsx("div",{className:"hidden md:block ml-2",children:"Delete"})]}),e.jsxs("div",{className:"flex items-center text-gray-300 hover:text-white cursor-pointer md:bg-dark-2 md:rounded md:px-2 md:py-1",role:"button",onClick:()=>s(!0),children:[e.jsx(k,{text:"Manage Command",children:e.jsx(me,{className:"h-5 w-5"})}),e.jsx("div",{className:"hidden md:block ml-2",children:"Manage"})]})]})]},"2")}),S&&e.jsx(ue,{title:"Are you sure that you want to delete the command?",subTitle:"The command will be deleted permanently and can't be restored.",onClose:()=>h(!1),onConfirm:C})]})}function De({setCreate:l,cancelable:a}){const c=B(x=>x.guildId),t=L(x=>x.create),[s,n]=p.useState(""),[i,r]=p.useState(""),[o,m]=p.useState([]),N=X(),u=he();function j(){if(s.length==0||i.length==0||!c)return;const x=b.getState().actions.new;u.mutate({guildId:c,req:{name:s,description:i,parameters:o,actions:x||null}},{onSuccess:g=>{g.success?(n(""),r(""),l(!1),N.invalidateQueries(["custom-bot",c,"commands"])):t({title:"Failed to create command",message:g.error.message,type:"error"})}})}return e.jsxs("div",{className:"bg-dark-3 p-5 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 truncate text-lg mb-5 justify-between",children:[e.jsxs("div",{className:"text-white truncate",children:[e.jsx("span",{className:"font-bold text-gray-500 text-xl",children:"/"})," ",s]}),e.jsxs("div",{className:"flex flex-none items-center space-x-4 md:space-x-3",children:[a&&e.jsxs("div",{className:"flex items-center text-gray-300 hover:text-white cursor-pointer md:bg-dark-2 md:rounded md:px-2 md:py-1",role:"button",onClick:()=>l(!1),children:[e.jsx(k,{text:"Cancel",children:e.jsx(pe,{className:"h-5 w-5"})}),e.jsx("div",{className:"hidden md:block ml-2",children:"Cancel"})]}),e.jsxs("div",{className:"flex items-center text-white cursor-pointer bg-blurple hover:bg-blurple-dark rounded px-2 py-1",role:"button",onClick:j,children:[e.jsx(k,{text:"Create Custom Command",children:e.jsx(ge,{className:"h-5 w-5"})}),e.jsxs("div",{className:"ml-2",children:["Create ",e.jsx("span",{className:"hidden md:inline-block",children:"Command"})]})]})]})]}),e.jsxs("div",{className:"space-y-5 mb-5",children:[e.jsx(E,{label:"Name",type:"text",maxLength:32,value:s,onChange:n}),e.jsx(E,{label:"Description",type:"text",maxLength:100,value:i,onChange:r}),e.jsx(z,{parameters:o||[],setParameters:m,cmdId:"new"}),e.jsx(Z,{cmdId:"new"})]})]})}function Le(){var g,S;const{data:l}=fe(),a=L(h=>h.create),[c,t]=p.useState(!1),s=B(h=>h.guildId),n=T(),i=ve(s),r=(g=i.data)!=null&&g.success?i.data.data.length:0,o=T(s),m=(o==null?void 0:o.max_custom_commands)||0,N=je(),u=((S=i.data)==null?void 0:S.success)&&i.data.data.some(h=>!h.deployed_at||F(h.updated_at)>F(h.deployed_at));function j(){!s||!u||N.mutate({guildId:s},{onSuccess:h=>{h.success?i.refetch():a({title:"Failed to deploy commands",message:h.error.message,type:"error"})}})}const x=p.useMemo(()=>{var C;if(!((C=i.data)!=null&&C.success))return[];const h=i.data.data;return h.sort((v,d)=>v.name.localeCompare(d.name)),h},[i.data]);return e.jsx("div",{className:"overflow-y-auto w-full",children:e.jsxs("div",{className:"flex flex-col max-w-5xl mx-auto px-4 w-full my-5 lg:my-20",children:[e.jsxs("div",{className:"mb-10",children:[e.jsxs("div",{className:"text-white font-medium mb-3 flex items-center space-x-3",children:[e.jsx(be,{className:"h-7 w-7 text-yellow"}),e.jsx("div",{className:"text-2xl",children:"Custom Commands"}),e.jsxs("div",{className:"font-light italic text-gray-400 flex-none",children:[r," / ",m]})]}),e.jsx("div",{className:"text-gray-400 font-light text-sm",children:"You can create custom commands to add more functionality to your custom bot. You need to configure a custom bot first which is available to servers with premium in the settings."})]}),l!=null&&l.success?n!=null&&n.max_custom_commands?e.jsxs("div",{className:"space-y-5 mb-8",children:[e.jsxs(M,{className:"space-y-5 overlfow-y-auto",children:[x.map(h=>e.jsx(Te,{cmd:h},h.id)),(x.length===0||c)&&e.jsx(De,{setCreate:t,cancelable:x.length!==0})]}),e.jsxs("div",{className:"flex space-x-3 justify-end",children:[e.jsx("button",{className:y("px-3 py-2 rounded text-white",u?"bg-blurple hover:bg-blurple-dark":"bg-dark-2 cursor-not-allowed"),onClick:j,children:"Deploy Commands"}),e.jsx("button",{className:y("px-3 py-2 rounded border-2 text-white",x.length<m?"border-dark-7 hover:bg-dark-6 cursor-pointer":"border-dark-6 text-gray-300 cursor-not-allowed"),onClick:()=>x.length<m&&t(!0),children:"New Command"})]})]}):e.jsx(ye,{alwaysExpanded:!0}):e.jsx(Ne,{alwaysExpanded:!0})]})})}export{Le as default};
